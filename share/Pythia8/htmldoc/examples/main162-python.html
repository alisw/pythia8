<html><head><title>main162-python</title>
<link rel="stylesheet" type="text/css" href="../pythia.css"/>
<link rel="shortcut icon" href="../pythia32.gif"/></head><body><h2>main162-python</h2>
Back to <a href="../ExampleKeywords.html" target="page">index.</a>
<pre><code class="language-python">
# main162.py is a part of the PYTHIA event generator.
# Copyright (C) 2024 Torbjorn Sjostrand.
# PYTHIA is licenced under the GNU GPL v2 or later, see COPYING for details.
# Please respect the MCnet Guidelines, see GUIDELINES for details.

# Authors:
#            <a href="mailto:philten@cern.ch">Philip Ilten</a>
#            <a href="mailto:marius.m.utheim@jyu.fi">Marius Utheim</a>

# Keywords:
#            <a href="../ExampleKeywords.html#parallelism">Parallelism</a>
#            <a href="../ExampleKeywords.html#charged+multiplicity">Charged&nbsp;multiplicity</a>
#            <a href="../ExampleKeywords.html#python">Python</a>

# This is a simple test program to illustrate the usage of
# PythiaParallel in Python. The program is equivalent to main01, but in
# parallel. This program contains detailed comments about how the
# code works. For a shorter version that fits on a single slide, see
# main161.

# To set the path to the Pythia 8 Python interface do either
# (in a shell prompt):
#      export PYTHONPATH=$(PREFIX_LIB):$PYTHONPATH
# or the following which sets the path from within Python.
import sys
cfg = open(&quot;Makefile.inc&quot;)
lib = &quot;../lib&quot;
for line in cfg:
    if line.startswith(&quot;PREFIX_LIB=&quot;): lib = line[11:-1]; break
sys.path.insert(0, lib)

#==========================================================================

# Use the PythiaParallel class instead of Pythia for parallel generation.
# It will create multiple underlying Pythia instances to do the actual
# generation; one instance per thread.
import pythia8
pythia = pythia8.PythiaParallel()

# PythiaParallel reads settings the same way as the normal Pythia does.
# The settings will be copied for each Pythia instance.
pythia.readString(&quot;Beams:eCM = 8000.&quot;)
pythia.readString(&quot;HardQCD:all = on&quot;)
pythia.readString(&quot;PhaseSpace:pTHatMin = 20.&quot;)
pythia.readString(&quot;Main:numberOfEvents = 10000&quot;)

# The maximum degree of parallelism. If set to 0 (default), the program
# will use the maximum number of threads supported by the hardware.
pythia.readString(&quot;Parallelism:numThreads = 4&quot;)

# This tells PythiaParallel to not process events asynchronously
# (default behaviour). In Python, this should never be switched on
# because of the Python global interpreter lock (as is done in
# main163.cc for C++ code).
pythia.readString(&quot;Parallelism:processAsync = off&quot;)

# This defines the number of events generated by PythiaParallel::run.
pythia.readString(&quot;Main:numberOfEvents = 10000&quot;)

# Define the histogram to fill.
mult = pythia8.Hist(&quot;charged multiplicity&quot;, 100, -0.5, 799.5)

# This will create and initialize each underlying Pythia instance.
def init(pythiaNow):
    print(&quot;Initializing Pythia with index %i.&quot;
          % pythiaNow.settings.mode(&quot;Parallelism:index&quot;))
    return pythiaNow.init()
pythia.init(init)

# Generate events. Note, any type of function can be passed to this method,
# as long as the function takes an &apos;Pythia&apos; object as the argument.
def analyze(pythiaNow):
    mult.fill(pythiaNow.event.nFinal(True))
pythia.run(analyze)

# PythiaParallel::stat combines statistics for each Pythia instance.
pythia.stat()

# Output histogram.
print(mult)
</code></pre></body></html>